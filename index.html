<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sport Stacking Calculators</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Mobile scaling -->
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 10px;
    }
    h1 {
      margin-bottom: 10px;
    }
    .mode {
      display: none;
      margin-top: 20px;
    }
    label, input {
      margin: 5px;
    }
    .inputs {
      margin: 10px 0;
    }
    input[type="number"] {
      width: 100px;
      padding: 10px;
      margin: 5px;
      text-align: center;
      font-size: 18px;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
    }
    #average363Inputs {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
    }
    .stack-input {
      margin: 6px;
      font-size: 18px;
      padding: 10px;
    }

    /* Mobile tweaks */
    @media (max-width: 600px) {
      body {
        font-size: 18px;
      }
      input[type="number"] {
        width: 90px;
        font-size: 18px;
        padding: 10px;
      }
      button {
        font-size: 18px;
        padding: 12px 24px;
      }
    }
  </style>
</head>
<body>
  <h1>Sport Stacking Calculators</h1>
  <p>Select a mode below:</p>

  <select id="modeSelect" onchange="showMode()">
    <option value="tournament">Tournament</option>
    <option value="single">Single Time</option>
    <option value="average363">3-6-3 Average</option>
  </select>

  <!-- Tournament Mode -->
  <div id="tournament" class="mode">
    <h2>Tournament Mode</h2>
    <p>(Put 999 if scratch)</p>
    <form id="tournamentForm">
      <div class="inputs">
        <h3>3-3-3</h3>
        <input type="number" step="0.001" id="t333_1" placeholder="x.xxx">
        <input type="number" step="0.001" id="t333_2" placeholder="x.xxx">
        <input type="number" step="0.001" id="t333_3" placeholder="x.xxx">
      </div>
      <div class="inputs">
        <h3>3-6-3</h3>
        <input type="number" step="0.001" id="t363_1" placeholder="x.xxx">
        <input type="number" step="0.001" id="t363_2" placeholder="x.xxx">
        <input type="number" step="0.001" id="t363_3" placeholder="x.xxx">
      </div>
      <div class="inputs">
        <h3>Cycle</h3>
        <input type="number" step="0.001" id="tcycle_1" placeholder="x.xxx">
        <input type="number" step="0.001" id="tcycle_2" placeholder="x.xxx">
        <input type="number" step="0.001" id="tcycle_3" placeholder="x.xxx">
      </div>
      <button type="button" onclick="calculateTournament()">Calculate</button>
      <button type="button" onclick="confirmReset('tournament')">Reset</button>
    </form>
    <div id="tournamentResult"></div>
  </div>

  <!-- Single Time Mode -->
  <div id="single" class="mode">
    <h2>Single Time Mode</h2>
    <form id="singleForm">
      <div class="inputs">
        <label>3-3-3:</label>
        <input type="number" step="0.001" id="s333" placeholder="x.xxx">
      </div>
      <div class="inputs">
        <label>3-6-3:</label>
        <input type="number" step="0.001" id="s363" placeholder="x.xxx">
      </div>
      <div class="inputs">
        <label>Cycle:</label>
        <input type="number" step="0.001" id="scycle" placeholder="x.xxx">
      </div>
      <button type="button" onclick="calculateSingle()">Calculate</button>
      <button type="button" onclick="confirmReset('single')">Reset</button>
    </form>
    <div id="singleResult"></div>
  </div>

  <!-- 3-6-3 Average Calculator -->
  <div id="average363" class="mode">
    <h2>3-6-3 Average Calculator</h2>
    <form id="average363Form">
      <label>Average of
        <input type="number" id="numTimes" min="1" max="50" value="3" onchange="generate363Inputs()">
        times
      </label>
      <div id="average363Inputs"></div>
      <button type="button" onclick="calculateAverage363()">Calculate</button>
      <button type="button" onclick="confirmReset('average363')">Reset</button>
    </form>
    <div id="average363Result"></div>
  </div>

  <script>
    // Show mode
    function showMode() {
      let modes = document.querySelectorAll('.mode');
      modes.forEach(m => m.style.display = "none");
      let selected = document.getElementById("modeSelect").value;
      if (selected) {
        document.getElementById(selected).style.display = "block";
      }
    }

    // Confirm Reset
    function confirmReset(mode) {
      if (confirm("Are you sure you want to reset? All times will be cleared.")) {
        if (mode === "tournament") resetTournament();
        else if (mode === "single") resetSingle();
        else if (mode === "average363") resetAverage363();
      }
    }

    // Reset functions
    function resetTournament() {
      document.getElementById("tournamentForm").reset();
      document.getElementById("tournamentResult").innerHTML = "";
    }
    function resetSingle() {
      document.getElementById("singleForm").reset();
      document.getElementById("singleResult").innerHTML = "";
    }
    function resetAverage363() {
      document.getElementById("average363Form").reset();
      document.getElementById("average363Result").innerHTML = "";
      document.getElementById("average363Inputs").innerHTML = "";
    }

    // Tournament Calculation
    function calculateTournament() {
      function bestOfThree(a, b, c) {
        let times = [a, b, c].map(Number);
        if (times.every(t => t === 999)) return "Scratch";
        times = times.filter(t => t !== 999);
        return Math.min(...times).toFixed(3);
      }
      let best333 = bestOfThree(
        document.getElementById("t333_1").value,
        document.getElementById("t333_2").value,
        document.getElementById("t333_3").value
      );
      let best363 = bestOfThree(
        document.getElementById("t363_1").value,
        document.getElementById("t363_2").value,
        document.getElementById("t363_3").value
      );
      let bestCycle = bestOfThree(
        document.getElementById("tcycle_1").value,
        document.getElementById("tcycle_2").value,
        document.getElementById("tcycle_3").value
      );

      let resultDiv = document.getElementById("tournamentResult");
      if (best333 === "Scratch" || best363 === "Scratch" || bestCycle === "Scratch") {
        resultDiv.innerHTML = `<p>Overall: Scratch</p>
                               <p>3-3-3: ${best333}</p>
                               <p>3-6-3: ${best363}</p>
                               <p>Cycle: ${bestCycle}</p>`;
      } else {
        let overall = (parseFloat(best333) + parseFloat(best363) + parseFloat(bestCycle)).toFixed(3);
        resultDiv.innerHTML = `<p>Overall: ${overall}</p>
                               <p>3-3-3: ${best333}</p>
                               <p>3-6-3: ${best363}</p>
                               <p>Cycle: ${bestCycle}</p>`;
      }
    }

    // Single Mode Calculation
    function calculateSingle() {
      let s333 = parseFloat(document.getElementById("s333").value);
      let s363 = parseFloat(document.getElementById("s363").value);
      let scycle = parseFloat(document.getElementById("scycle").value);

      if (isNaN(s333) || isNaN(s363) || isNaN(scycle)) {
        document.getElementById("singleResult").innerHTML = "<p>Please enter all times.</p>";
        return;
      }
      let overall = (s333 + s363 + scycle).toFixed(3);
      document.getElementById("singleResult").innerHTML =
        `<p>Overall: ${overall}</p>
         <p>3-3-3: ${s333.toFixed(3)}</p>
         <p>3-6-3: ${s363.toFixed(3)}</p>
         <p>Cycle: ${scycle.toFixed(3)}</p>`;
    }

    // 3-6-3 Average
    function generate363Inputs() {
      let num = document.getElementById("numTimes").value;
      let inputsDiv = document.getElementById("average363Inputs");
      inputsDiv.innerHTML = "";
      for (let i = 0; i < num; i++) {
        let input = document.createElement("input");
        input.type = "number";
        input.step = "0.001";
        input.placeholder = "x.xx";
        input.classList.add("stack-input");
        input.id = "a363_" + i;
        inputsDiv.appendChild(input);
      }
    }

    function calculateAverage363() {
      let num = document.getElementById("numTimes").value;
      let times = [];
      for (let i = 0; i < num; i++) {
        let val = parseFloat(document.getElementById("a363_" + i).value);
        if (!isNaN(val)) times.push(val);
      }
      if (times.length === 0) {
        document.getElementById("average363Result").innerHTML = "<p>Please enter times.</p>";
        return;
      }
      let avg = (times.reduce((a, b) => a + b, 0) / times.length).toFixed(2);
      document.getElementById("average363Result").innerHTML = `<p>Average: ${avg}</p>`;
    }

    // Default: show Tournament on load
    document.getElementById("modeSelect").value = "tournament";
    showMode();
  </script>
</body>
</html>
